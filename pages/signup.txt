import streamlit as st
import sys
import os
sys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__), "..")))
from utils import *

st.title("Sign Up")

username = st.text_input("Username")
email = st.text_input("Email")
password = st.text_input("Password", type="password")
confirm = st.text_input("Confirm Password", type="password")

if st.button("Sign Up"):
    if password != confirm:
        st.error("Passwords don't match")
    elif email in users:
        st.error("Email already exists")
    elif username and email and password:
        users[email] = {"username": username, "password": password, "free_count": 0, "is_pro": False}
        save_json("users.json", users)
        st.session_state.user_email = email
        st.session_state.username = username
        st.success("Signed up successfully!")
        st.rerun()
    else:
        st.error("Fill in all fields")

st.markdown("Already have an account? [Sign In](/account)")

# Bottom Navigation
st.markdown("""
<style>
    .bottom-nav {position:fixed;bottom:0;left:0;right:0;background:#00D1B2;padding:14px;display:flex;justify-content:space-around;z-index:9999;box-shadow:0 -4px 20px rgba(0,0,0,0.3);font-weight:600;}
    .bottom-nav a {color:white;text-decoration:none;}
</style>
<div class="bottom-nav">
    <a href="/" target="_self">Home</a>
    <a href="/checklist" target="_self">Checklist</a>
    <a href="/community" target="_self">Community</a>
    <a href="/account" target="_self">Account</a>
    <a href="/settings" target="_self">Settings</a>
</div>
""", unsafe_allow_html=True)